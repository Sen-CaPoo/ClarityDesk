# 客服來電問題紀錄與分析系統—需求說明

## 1) 目標與範圍

建置一套用於「紀錄、查詢、分析」用戶來電之系統問題的內部系統；提供清楚的檢索、狀態追蹤、匯出報表與通知機制，支援行動與桌面裝置的響應式版面。

---

## 2) 使用者角色

* **管理者**：新增/編輯/刪除紀錄、維護選單（詢問系統清單、處理人對應表）、下載報表、檢視全站分析。
* **客服人員**：新增/編輯紀錄、查詢/篩選、下載報表。

---

## 3) 主畫面（清單）功能

### 3.1 搜尋與篩選

* **關鍵字模糊搜尋**

  * 介面：關鍵字輸入框 + Checkbox（「主旨」、「內文」）。
  * 預設兩者皆勾選；搜尋邏輯為包含式（LIKE %keyword%）。
* **日期區間**：依「來電日期（建立時間）」篩選，提供快速選擇（今天、本週、本月、上月、近7天、自訂）。
* **詢問系統**：下拉式選單（可多選），初始項目：`客語 / 體育局獎補助 / 教育局獎學金 / 基站 / 龍舟`。
* **處理狀態**：單選或多選篩選（`未處理 / 已完成`）。
* **緊急度**：單選或多選篩選（`低 / 中 / 高`）。
* **排序**：預設依「來電日期（新→舊）」再依「緊急度（高→低）」；使用者可切換欄位排序。
* **分頁**：每頁 20 筆（可切換 20/50/100）。

### 3.2 清單呈現

* 顯示欄位：來電日期、詢問系統、主旨、緊急度、處理狀態、處理人員、聯絡人、連絡電話、最後更新時間。
* 緊急度以色彩或標籤強調（高→醒目）。
* 主旨可以點擊並跳出彈跳視窗顯示內文。

### 3.3 下載報表

* 依「目前查詢結果」產出 **.xlsx**（更正副檔名）。
* 檔案內容含：篩選條件摘要 + 明細（所有顯示欄位）+ 隱藏欄位（內容、備註、參考FAQ 等）。
* 欄位順序與系統欄位說明一致；日期時間格式 `YYYY/MM/DD HH:MM`。

---

## 4) 紀錄功能（新增/明細）

### 4.1 必要欄位與型別

* **詢問系統**（下拉）：`客語 / 體育局獎補助 / 教育局獎學金 / 基站 / 龍舟`（可由管理者維護增減）。
* **主旨**（必填，最長 50字）。
* **內容**（必填，富文字或純文字，最長 150 字）。
* **緊急度**（下拉：`低 / 中 / 高`，預設「中」）。
* **連絡電話**（必填；格式驗證）。
* **聯絡人**（必填）。
* **處理人員**（自動帶入；可由權限者改選）。
* **參考 FAQ**（選填；可輸入連結或選取系統內 FAQ）。
* **備註**（選填）。
* 系統欄位：建立者、建立時間、最後更新者、最後更新時間。

### 4.2 自動指派處理人（對應規則）

* 依「詢問系統 → 處理人員」之對應表自動帶入。
* 若對應不到，顯示提示並要求選擇處理人員後方可儲存。
* 對應表由管理者於後台維護。

### 4.3 通知機制（Line@）

* **觸發時機**：紀錄 **首次儲存** 成功後，立即以 Line@ 對「處理人員」發送通知一次。
* **避免重複**：後續「編輯/更新」不再自動發送通知。
* **稽核**：紀錄通知時間與對象；失敗需顯示重試/補送（手動）按鈕（選配）。

---

## 5) 編輯與維護

* **編輯紀錄**：可修改上述欄位；系統保留修改軌跡（誰在何時改了哪些欄位）。
* **詢問系統清單維護**：管理者可新增、停用、排序；停用項目不影響既有歷史紀錄。
* **處理人對應表維護**：管理者維護「詢問系統 ↔ 處理人員」對應，支援多對一或一對多（選配：若多位處理人則需定義主要處理人）。
* **某一紀錄同時多人編輯**：限制僅1人可以編輯，不可多人同時編輯某紀錄，編輯中狀態紀錄僅供其他使用者檢視。
---

## 6) 狀態與流程

* **處理狀態**：`未處理 / 已完成`（預設：未處理）。
* 清單可快速切換狀態；切換「已完成」需記錄完成時間與完成者。

---

## 7) FAQ 串接（參考）

* 於紀錄中可挑選「參考 FAQ」：支援以關鍵字搜尋 FAQ，或直接貼入外部連結。
* 清單/明細顯示 FAQ 連結，供客服快速回覆。

---

## 8) 響應式與易用性

* **RWD 斷點**：≥1280 桌面、768–1279 平板、≤767 手機。
* 手機端：搜尋條件摺疊、清單以卡片呈現；重要欄位置頂（主旨、緊急度、處理狀態、處理人、來電日期）。
* 表單欄位提供即時驗證與清楚的錯誤訊息。

---

## 9) 非功能性需求（重點）

* **稽核**：所有新增/修改/狀態變更/通知發送均留軌跡。
* **權限**：依角色限制可見欄位與可編輯欄位。
* **時區**：以 Asia/Taipei 儲存與顯示。

---

## 10) 驗收重點（逐條對應）

1. **搜尋/篩選**：可依關鍵字（主旨/內文可切換）、日期區間、詢問系統、處理狀態、緊急度進行查詢；結果正確且可排序/分頁。
2. **下載報表**：依目前結果匯出 **.xlsx**，欄位與格式符合規範。
3. **新增紀錄**：欄位與驗證符合；儲存成功後自動指派處理人（若有對應）；必填欄位未填不可送出。
4. **編輯紀錄**：可更新欄位並保留變更記錄；可維護「詢問系統」選項。
5. **自動對應處理人**：依對應表正確帶入；對不到時需提示並不要求選擇。
6. **Line@ 通知**：首次儲存成功即發送一次，後續編輯不再自動發送；可於紀錄看到通知時間。
7. **響應式**：於桌面/平板/手機呈現正確、可用。

---

## 11) 補充

1. 若「處理人員」多人，通知群發
2. FAQ 來源為手動輸入或可以對應另外FAQ系統之問題編號是
3. 報表要有彙總頁，按月/系統/處理人統計，統計選擇時間區間個項目總筆數